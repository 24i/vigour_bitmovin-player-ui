<!DOCTYPE html>
<!--
  ~ Copyright (C) 2016, bitmovin GmbH, All Rights Reserved
  ~
  ~ Authors: Mario Guggenberger <mario.guggenberger@bitmovin.com>
  ~
  ~ This source code and its use and distribution, is subject to the terms
  ~ and conditions of the applicable license agreement.
  -->

<html>
<head>
    <meta charset="UTF-8"/>
    <title>Bitmovin Player UI Demo</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="css/demo.css">
    <link rel="stylesheet" href="css/bitmovin-playerui.css">
</head>
<body>

<div class="container">
    <div class="player-wrapper">
        <div class="player" id="player"></div>
    </div>

    <br>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">Playground</h3>
        </div>
        <div class="panel-body">

            <h4>Player Config</h4>

            <form class="form-horizontal">
                <div class="form-group">
                    <label for="config-source" class="col-sm-4 control-label">Video Source</label>
                    <div class="col-sm-4">
                        <select class="form-control" id="config-source"></select>
                    </div>
                    <span class="col-sm-4 help-block">The video source to load into the player.</span>
                </div>
            </form>

            <h4>Playback Control</h4>

            <div id="playback-controls"></div>

            <h5>Actions</h5>

            <button type="button" class="btn btn-primary btn-sm" id="btn-action-subtitle-add">Add subtitle</button>
            <button type="button" class="btn btn-primary btn-sm" id="btn-action-subtitle-remove">Remove subtitle</button>

            <h5>Output</h5>

            <div class="well"><samp id="function-call-output"></samp></div>

            <h4>Various</h4>

            <form class="form-horizontal">
                <div class="form-group">
                    <label for="config-various-allevents" class="col-sm-4 control-label">Listen to all events</label>
                    <div class="col-sm-4">
                        <input type="checkbox" id="config-various-allevents">
                    </div>
                    <span class="col-sm-4 help-block">Logs all fired events to the console</span>
                </div>
            </form>

        </div>
    </div>
</div>

<script src="//bitmovin-a.akamaihd.net/bitmovin-player/stable/6/bitmovinplayer.min.js"></script>
<script src="js/bitmovin-playerui.js"></script>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script type="text/javascript">

    var player = bitmovin.player('player');

    var sources = {
        default: {
            dash: 'http://bitdash-a.akamaihd.net/content/sintel/sintel.mpd'
        },
        vr: {
            dash: 'https://bitmovin-a.akamaihd.net/content/playhouse-vr/mpds/105560.mpd',
            vr: {
                contentType: 'single'
            }
        },
        posterAndThumbnails: {
            dash: '//bitdash-a.akamaihd.net/content/MI201109210084_1/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd',
            hls: '//bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',
            progressive: '//bitdash-a.akamaihd.net/content/MI201109210084_1/MI201109210084_mpeg-4_hd_high_1080p25_10mbits.mp4',
            poster: '//bitdash-a.akamaihd.net/content/art-of-motion_drm/art-of-motion_poster.jpg',
            tracks: [{
                file: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/thumbnails/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.vtt',
                kind: 'thumbnails'
            }], userId: "demo_html5_vts", videoId: "art-of-motion"
        },
        live: {
            dash: 'http://bitcdn-kronehit-live.bitmovin.com/mpds/stream-full.php?streamkey=bitcodin&segmenthost=bitcdn-kronehit-live.bitmovin.com&liveoffset=20'
        },
        liveWithTimeshift: {
            dash: 'http://demo-dash-live.zahs.tv/hd/manifest.mpd?timeshift=100'
        }
    };

    var conf = {
        key: 'YOUR KEY HERE',
        source: sources.default,
        style: {
            ux: false
        },
        cast: {
            enable: true
        }
    };

    player.setup(conf).then(function () {
        // Add UI to loaded player
        bitmovin.playerui.UIManager.Factory.buildDefaultUI(player, {
            metadata: {
                title: "UI Demo Video Title"
            }
        });
    }, function (errorEvent) {
        // Play setup failed, and there's no player UI yet to display the error in
        console.log(errorEvent);
    });

    $.each(sources, function (key, value) {
        $('#config-source').append($("<option></option>").attr("value", key).text(key));
    });
    $('#config-source').change(function () {
        player.unload();
        player.load(sources[$(this).val()]);
    });

    var printResult = function (result) {
        $("#function-call-output").html(JSON.stringify(result, null, 2));
    };

    var playbackControls = [];
    for (var member in player) {
        if (typeof player[member] == "function") {
            playbackControls.push(member);
        }
    }
    $.each(playbackControls, function (key, name) {
        var button = $('<a class="btn btn-primary btn-sm"><code>' + name + '</code></a>');
        $('#playback-controls').append(button);
        button.click(function () {
            printResult(player[name]());
        });
    });

    $("#btn-action-subtitle-add").click(function () {
        printResult(player.addSubtitle("http://bitdash-a.akamaihd.net/content/sintel/subtitles/subtitles_en.vtt", "test", "subtitle", "ru", "Test Subtitle"));
    });
    $("#btn-action-subtitle-remove").click(function () {
        printResult(player.removeSubtitle("test"));
    });

    var allEventsListener = function (event) {
        console.log(event);
    };
    $('#config-various-allevents').change(function () {
        var checked = $(this).prop('checked');
        for (var event in bitmovin.player.EVENT) {
            if(checked) {
                player.addEventHandler(bitmovin.player.EVENT[event], allEventsListener);
            } else {
                player.removeEventHandler(bitmovin.player.EVENT[event], allEventsListener);
            }
        }
    });

</script>
</body>
</html>